// Online C++ compiler to run C++ program online
#include <iostream>
#include <bits/stdc++.h>
using namespace std;

/*
  Node structure for singly linked list
  data  -> stores the value
  next  -> pointer to the next node
*/
struct Node {
    int data;
    Node* next;

    // Constructor to initialize a node
    Node(int value) {
        data = value;
        next = nullptr;
    }
};

/*
  Function to insert a node at the end of the linked list
*/
Node* createLinkedList(int data, Node* head) {
    Node* temp = head;
    Node* newNode = new Node(data);

    // If list is empty, new node becomes head
    if (head == nullptr) {
        return newNode;
    }

    // Traverse to the last node
    while (temp->next != nullptr) {
        temp = temp->next;
    }

    // Attach new node at the end
    temp->next = newNode;

    return head;
}

/*
  Function to insert a node at the beginning of the linked list
*/
Node* insertAtStart(int data, Node* head) {
    Node* newNode = new Node(data);

    // If list is empty, new node becomes head
    if (head == nullptr) {
        return newNode;
    }

    // Point new node to current head
    newNode->next = head;

    // Return new node as head
    return newNode;
}

/*
  Function to delete a node from the beginning of the linked list
*/
Node* deleteFromStart(Node* head) {
    if (head == nullptr) {
        cout << "\nNothing to delete. List is empty.";
        return head;
    }

    // Store current head
    Node* temp = head;

    // Move head to next node
    head = head->next;

    // Delete old head
    delete temp;

    return head;
}

/*
  Function to delete a node from the end of the linked list
*/
Node* deleteFromEnd(Node* head) {
    if (head == nullptr) {
        cout << "\nNothing to delete. List is empty.";
        return head;
    }

    // If only one node exists
    if (head->next == nullptr) {
        delete head;
        return nullptr;
    }

    Node* temp = head;

    // Traverse to the second last node
    while (temp->next->next != nullptr) {
        temp = temp->next;
    }

    // Store last node
    Node* deleteNode = temp->next;

    // Remove last node
    temp->next = nullptr;

    delete deleteNode;

    return head;
}

/*
  Function to insert a node at a given position (0-based index)
*/
Node* insertAtPosition(int data, Node* head, int pos) {
    Node* temp = head;
    Node* newNode = new Node(data);

    // Insert at beginning
    if (pos == 0) {
        return insertAtStart(data, head);
    }

    // Traverse to (pos - 1)th node
    for (int i = 0; i < pos - 1; i++) {
        temp = temp->next;
    }

    // Adjust pointers
    newNode->next = temp->next;
    temp->next = newNode;

    return head;
}

/*
  Function to delete a node from a given position (0-based index)
*/
Node* deleteAtPosition(Node* head, int pos) {
    // Delete from start
    if (pos == 0) {
        return deleteFromStart(head);
    }

    Node* temp = head;

    // Traverse to (pos - 1)th node
    for (int i = 0; i < pos - 1; i++) {
        temp = temp->next;
    }

    // Node to be deleted
    Node* toDelete = temp->next;

    // Skip the node
    temp->next = toDelete->next;

    // Free memory
    delete toDelete;

    return head;
}

/*
  Function to print the linked list
*/
void printLinkedList(Node* head) {
    Node* temp = head;

    cout << "\nElements in Linked List is: ";

    if (head == nullptr) {
        cout << "\nList is empty.";
        return;
    }

    // Traverse and print values
    while (temp != nullptr) {
        cout << " " << temp->data;
        temp = temp->next;
    }
}

int main() {
    int no_of_nodes;

    cout << "\nEnter Number of Nodes to Insert in Linked List: ";
    cin >> no_of_nodes;

    Node* head = nullptr;
    int added = 0;
    int choice;

    // Choice for insertion method
    cout << "\nInsert at End - 1, Insert at Start - 2: ";
    cin >> choice;

    // Insert nodes
    if (choice == 1) {
        while (added < no_of_nodes) {
            int value;
            cout << "\nEnter value to insert into Node: ";
            cin >> value;
            head = createLinkedList(value, head);
            added++;
        }
    } else {
        while (added < no_of_nodes) {
            int value;
            cout << "\nEnter value to insert into Node: ";
            cin >> value;
            head = insertAtStart(value, head);
            added++;
        }
    }

    printLinkedList(head);

    // Choice for deletion method
    cout << "\n\nDelete from Start - 1, Delete from End - 2: ";
    cin >> choice;

    if (choice == 1) {
        head = deleteFromStart(head);
        added--;
    } else {
        head = deleteFromEnd(head);
        added--;
    }

    printLinkedList(head);

    // Insert at random position
    cout << "\n\nDo you want to insert at random position in List : 1 - Yes, 2 - No (0 based index): ";
    cin >> choice;

    if (choice == 1) {
        int val, pos;
        cout << "\nEnter value to insert: ";
        cin >> val;

        cout << "\nEnter the position to insert: ";
        cin >> pos;

        if (pos > added) {
            cout << "\nOut of range position.";
        } else {
            head = insertAtPosition(val, head, pos);
            added++;
        }
    }

    printLinkedList(head);

    // Delete at random position
    cout << "\n\nDo you want to delete at random position in List : 1 - Yes, 2 - No (0 based index): ";
    cin >> choice;

    if (choice == 1) {
        int pos;
        cout << "\nEnter the position to delete: ";
        cin >> pos;

        if (pos > added - 1) {
            cout << "\nOut of range position.";
        } else {
            head = deleteAtPosition(head, pos);
            added--;
        }
    }

    printLinkedList(head);

    return 0;
}
